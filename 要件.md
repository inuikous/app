# 画像解析システム 要件定義書

## 1. システム概要
画像内に描画された記号（ハートマーク、アルファベット）を検出し、その角度や文字種を解析するシステム

## 2. 機能要件

### 2.1 解析対象データ
画像内には以下の3つの要素が配置される：

#### 2.1.1 ハートマーク（♡）
- **位置**: 画像の左下
- **色**: 黒色
- **特性**: 様々な角度で回転している
- **解析内容**: 回転角度を検出

#### 2.1.2 右上アルファベット
- **位置**: 画像の右上
- **形式**: 黒い円（●）の中にアルファベット（A～F）を表示
- **特性**: 様々な角度で回転している
- **解析内容**: アルファベット文字を識別

#### 2.1.3 右下アルファベット
- **位置**: 画像の右下
- **形式**: 黒い円（●）の中にアルファベット（A～F）を表示
- **特性**: 様々な角度で回転している
- **解析内容**: アルファベット文字を識別

### 2.2 入出力仕様

#### 2.2.1 入力
- **形式**: 画像ファイル（PNG、JPG等）
- **場所**: 指定された入力ディレクトリ内の全画像ファイル
- **処理**: ディレクトリ内の画像を順次処理

#### 2.2.2 出力
- **形式**: 画像ファイル（入力と同じ形式）
- **場所**: 指定された出力ディレクトリ
- **内容**: 
  - 元の画像に解析結果を描画
  - ハートの角度を表示
  - 右上・右下のアルファベット文字を表示

### 2.3 設定可能なパラメータ（定数）

以下のパラメータは設定ファイルまたはコード内の定数として変更可能：

- **画像サイズ**: 幅・高さ（ピクセル）
- **ハートマークのサイズ**: 縦・横のサイズ
- **アルファベット円のサイズ**: 円の直径、文字のサイズ
- **各要素の配置位置**: 左下、右上、右下の具体的な座標オフセット

## 3. 非機能要件

### 3.1 精度要件
- 角度検出精度: ±5度以内
- 文字認識精度: 95%以上

### 3.2 性能要件
- 1画像あたりの処理時間: 5秒以内（目安）

### 3.3 拡張性
- 新しいアルファベット（G～Z）への対応が容易
- 画像サイズやマークサイズの変更が容易

## 4. データセット生成要件

### 4.1 生成データの仕様
- **ハートマークの角度**: 0～360度の範囲でランダム
- **アルファベット**: A～Fの6文字からランダムに選択
- **アルファベットの角度**: 0～360度の範囲でランダム
- **生成枚数**: 設定可能（デフォルト: 100枚程度）

### 4.2 ファイル命名規則
生成される画像ファイル名には正解ラベルを含める：
- 形式例: `image_heart{角度}_top{文字}{角度}_bottom{文字}{角度}.png`
- 例: `image_heart45_topA30_bottomB270.png`

### 4.3 メタデータ
CSV形式で各画像の正解データを出力：
- ファイル名
- ハート角度
- 右上文字
- 右上角度
- 右下文字
- 右下角度

## 5. システム構成

### 5.1 ディレクトリ構造
```
PatternMatching/
├── app/
│   ├── dataset_generator/    # データセット生成スクリプト
│   ├── analyzer/              # 画像解析スクリプト
│   ├── input/                 # 入力画像ディレクトリ
│   ├── output/                # 出力画像ディレクトリ
│   ├── dataset/               # 生成されたデータセット
│   └── config/                # 設定ファイル
```

### 5.2 技術スタック
- **プログラミング言語**: Python 3.x
- **画像処理ライブラリ**: 
  - PIL/Pillow（画像生成・描画）
  - OpenCV（画像解析）
  - NumPy（数値計算）
- **機械学習（オプション）**: 
  - TensorFlow/PyTorch（高精度な文字認識が必要な場合）

## 6. 開発フェーズ

### Phase 1: データセット生成（本フェーズ）
- ✓ データセット生成スクリプトの実装
- ✓ テストデータの生成と検証

### Phase 2: 画像解析機能の実装
- ハート角度検出アルゴリズムの実装
- アルファベット文字認識アルゴリズムの実装
- 角度検出アルゴリズムの実装

### Phase 3: 統合・評価
- 入出力処理の実装
- 精度評価
- パラメータチューニング

## 7. 補足事項

### 7.1 角度の定義
- 0度: 元の向き（上向き）
- 時計回りを正の角度として定義
- 角度範囲: 0～359度

### 7.2 座標系
- 原点: 画像の左上
- X軸: 右方向が正
- Y軸: 下方向が正
